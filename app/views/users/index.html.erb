<div>
  <span style="display: inline-block">
    <h2 class="title is-4">Users (<%= @users.count %>)</h2>
  </span>
  <span style="float: right">
    <a href="<%= new_user_invitation_path %>" class="button is-link">Invite User</a>
  </span>
</div>

<br>

<% if @users.empty? %>
  No users
  <br />
<% else %>
<table class="users-table hover stripe">
  <thead>
    <tr>
      <th>Username</th>
      <th>Status</th>
      <th>Email</th>
      <th>Role</th>
      <th>Created At</th>
      <th>Disable</th>
    </tr>
  </thead>

  <tbody>
    <% @users.each do |user| %>
      <tr>
        <td><%= user.username %></td>
        <td><%= user.status.upcase %></td>
        <td><%= user.email %></td>
        <td><%= user.admin? ? "admin" : "user" %></td>
        <td><%= user.created_at %></td>
        <% if not user.active_for_authentication? %>
          <td></td>
        <% elsif user.admin && User.admins.count == 1%>
          <td>Can't disable last admin</td>
        <% elsif @users.count == 1 %>
          <td>Can't disable last user</td>
        <% else %>
          <td><%= link_to 'Disable', user, method: :delete %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
<% end %>

<script>
  $(document).ready(function() {
    $(".users-table").DataTable({
      "pagingType": "simple_numbers",
    });

    // style datatable search inputs
    $(".dataTables_filter input").addClass("input");
    $(".dataTables_filter input").attr("placeholder", "Search");
  });
</script>
